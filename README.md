# Домашнее задание к занятию «Микросервисы: подходы» - `Мальцев Виктор`

---

Задача 1: Обеспечить разработку

Предложите решение для обеспечения процесса разработки: хранение исходного кода, непрерывная интеграция и непрерывная поставка. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

    облачная система;
    система контроля версий Git;
    репозиторий на каждый сервис;
    запуск сборки по событию из системы контроля версий;
    запуск сборки по кнопке с указанием параметров;
    возможность привязать настройки к каждой сборке;
    возможность создания шаблонов для различных конфигураций сборок;
    возможность безопасного хранения секретных данных (пароли, ключи доступа);
    несколько конфигураций для сборки из одного репозитория;
    кастомные шаги при сборке;
    собственные докер-образы для сборки проектов;
    возможность развернуть агентов сборки на собственных серверах;
    возможность параллельного запуска нескольких сборок;
    возможность параллельного запуска тестов.

Обоснуйте свой выбор.

Ответ:

Для решения задачи построения процесса разработки с учетом указанных требований предлагаю использовать комбинацию следующих инструментов:

1. GitHub или GitLab для хранения исходного кода: Оба эти инструмента поддерживают Git и предоставляют облачные решения для хранения кода. Они также позволяют создавать отдельные репозитории для каждого сервиса.

2. Jenkins для непрерывной интеграции (CI) и непрерывной доставки (CD): Jenkins – это инструмент, который позволяет автоматизировать различные этапы разработки. Он обеспечивает:

    Запуск сборки по событию из системы контроля версий.
    Запуск сборки по кнопке с указанием параметров.
    Возможность создания шаблонов для различных конфигураций сборок.
    Безопасное хранение секретных данных.
    Поддержку нескольких конфигураций для сборки из одного репозитория.
    Кастомные шаги при сборке.
    Использование собственных Docker-образов для сборки проектов.
    Возможность развернуть агенты сборки на собственных серверах.
    Поддержку параллельного запуска нескольких сборок и тестов.
    Docker для управления контейнерами: Docker позволяет создавать и использовать собственные образы для сборки и тестирования приложений, что упрощает управление зависимостями и окружением.

3. Kubernetes для оркестрации контейнеров (при необходимости): Если нужно масштабировать процессы CI/CD и управлять развертыванием приложений в контейнерах, Kubernetes является отличным решением.

Принципы взаимодействия:

    Интеграция GitHub/GitLab и Jenkins: При каждом push в репозиторий GitHub или GitLab, Jenkins автоматически получает уведомление и начинает процесс сборки/тестирования.
    Использование Jenkinsfile: Для определения процесса CI/CD используются Jenkinsfile, которые хранятся в репозитории и описывают шаги сборки, тестирования и развертывания.
    Docker в Jenkins: Jenkins использует Docker для запуска сборок в изолированной среде, обеспечивая таким образом консистентность и управляемость процесса.
    Kubernetes для масштабирования (при необходимости): Если требуется масштабирование, Jenkins может управлять задачами сборки и развертывания через Kubernetes.

Эта комбинация инструментов обеспечивает гибкость, масштабируемость и безопасность, необходимые для современной разработки ПО, и полностью соответствует заданным требованиям.

---

Задача 2: Логи

Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

    сбор логов в центральное хранилище со всех хостов, обслуживающих систему;
    минимальные требования к приложениям, сбор логов из stdout;
    гарантированная доставка логов до центрального хранилища;
    обеспечение поиска и фильтрации по записям логов;
    обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;
    возможность дать ссылку на сохранённый поиск по записям логов.

Обоснуйте свой выбор.

Ответ:

Для сбора и анализа логов в микросервисной архитектуре я предлагаю использовать комбинацию следующих инструментов:

1. Fluentd или Logstash для сбора логов: Эти инструменты позволяют собирать логи со всех хостов и отправлять их в центральное хранилище. Они поддерживают сбор логов из stdout, что удовлетворяет требованию минимальных изменений в приложениях.

2. Elasticsearch как центральное хранилище логов: Elasticsearch обеспечивает эффективное хранение, поиск и фильтрацию больших объемов логов. Он способен обрабатывать данные в реальном времени, что является ключевым фактором для анализа логов микросервисных систем.

3. Kibana для визуализации и анализа логов: Kibana предоставляет мощный и пользовательский интерфейс для визуализации данных из Elasticsearch. Это позволяет разработчикам и аналитикам легко искать, просматривать и анализировать логи.

Принципы взаимодействия:

    Сбор логов с помощью Fluentd/Logstash: Эти инструменты устанавливаются на каждом хосте и конфигурируются для сбора логов из stdout. Затем они отправляют собранные логи в Elasticsearch.
    Хранение и индексация в Elasticsearch: Elasticsearch обрабатывает и хранит логи, обеспечивая возможность быстрого поиска и анализа больших объемов данных.
    Визуализация в Kibana: Разработчики и аналитики используют Kibana для просмотра и анализа логов. Kibana предоставляет гибкие инструменты для фильтрации и поиска, а также возможность создавать дашборды и отчеты.
    Гарантированная доставка логов: Fluentd и Logstash поддерживают различные механизмы для обеспечения надежной доставки логов, включая буферизацию и повторные попытки отправки.

Эта комбинация обеспечивает полный пайплайн для сбора, хранения, поиска и визуализации логов. Она подходит для микросервисных архитектур благодаря своей масштабируемости и гибкости. Кроме того, она обеспечивает удобный пользовательский интерфейс для разработчиков и возможность делиться ссылками на сохраненные поиски, что упрощает совместную работу и ускоряет процесс поиска и устранения ошибок.

---

Задача 3: Мониторинг

Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

    сбор метрик со всех хостов, обслуживающих систему;
    сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;
    сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;
    сбор метрик, специфичных для каждого сервиса;
    пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;
    пользовательский интерфейс с возможностью настраивать различные панели для отслеживания состояния системы.

Обоснуйте свой выбор.

Ответ:

Для сбора и анализа состояния хостов и сервисов в микросервисной архитектуре, я предлагаю использовать следующую комбинацию инструментов:

1. Prometheus для сбора метрик: Prometheus - это мощная система мониторинга и алертинга, которая идеально подходит для сбора метрик со всех хостов и сервисов. Она может собирать метрики CPU, RAM, HDD, Network и другие специфические метрики для каждого сервиса.

2. Node Exporter для сбора метрик хостов: Node Exporter - это экспортер Prometheus, предназначенный для сбора метрик с хостов на уровне аппаратного и операционного обеспечения и предоставления их в формате, понятном для Prometheus.

3. cAdvisor или Docker Stats для сбора метрик контейнеров: Эти инструменты предназначены для сбора информации о использовании ресурсов и производительности контейнеров, включая CPU, RAM и сетевые показатели.

4. Grafana для визуализации и анализа данных: Grafana предоставляет мощный и гибкий пользовательский интерфейс для визуализации метрик, собранных Prometheus. Это позволяет создавать различные панели управления для отслеживания состояния системы и агрегации данных.

Принципы взаимодействия:

    Сбор метрик с помощью Prometheus: Prometheus регулярно опрашивает Node Exporter, cAdvisor и другие экспортеры для сбора метрик. Он хранит эти данные и предоставляет возможности для их агрегации и анализа.
    Использование Node Exporter и cAdvisor: Node Exporter собирает метрики на уровне хоста, в то время как cAdvisor собирает метрики на уровне контейнеров. Эти данные затем отправляются в Prometheus.
    Визуализация в Grafana: Grafana подключается к Prometheus и позволяет создавать настраиваемые дашборды для отображения и анализа собранных метрик. Это обеспечивает глубокое понимание производительности и состояния системы.

Эта комбинация инструментов обеспечивает комплексный и гибкий подход к мониторингу микросервисных архитектур. Она позволяет не только собирать подробные метрики по каждому хосту и сервису, но и предоставляет мощные средства для визуализации и анализа этих данных, что критически важно для оперативного управления производительностью и надежностью системы.

---

